 {
    "article_id": "7133793654912581639",
    "audit_status": 2,
    "brief_content": "Compose\u5236\u4f5c\u4e00\u4e2a\u5f53\u4e0b\u70ed\u95e8\u7684\u77ed\u89c6\u9891\u7ffb\u9875\u6d41App\uff0c\u90fd\u5e94\u8be5\u6709\u7684\u89c6\u9891\u8fdb\u5ea6\u6761Loading\uff0c\u770b\u5b8c\u522b\u5fd8\u8bb0\uff1a\u70b9\u8d5e\u2764\ufe0f+\u5173\u6ce8\u2764\ufe0f+\u6536\u85cf\u2764\ufe0f \u4e09\u8fde~~~",
    "category_id": "6809635626879549454",
    "collect_count": 0,
    "comment_count": 0,
    "content": "",
    "cover_image": "",
    "ctime": "1660965858",
    "digg_count": 1,
    "display_count": 0,
    "draft_id": "7133503767420338206",
    "hot_index": 5,
    "is_english": 0,
    "is_gfw": 0,
    "is_hot": 0,
    "is_markdown": 1,
    "is_original": 1,
    "link_url": "",
    "mark_content": "---\ntheme: smartblue\n---\n\u643a\u624b\u521b\u4f5c\uff0c\u5171\u540c\u6210\u957f\uff01\u8fd9\u662f\u6211\u53c2\u4e0e\u300c\u6398\u91d1\u65e5\u65b0\u8ba1\u5212 \u00b7 8 \u6708\u66f4\u6587\u6311\u6218\u300d\u7684\u7b2c1\u5929\uff0c[\u70b9\u51fb\u67e5\u770b\u6d3b\u52a8\u8be6\u60c5](https://juejin.cn/post/7123120819437322247 \"https://juejin.cn/post/7123120819437322247\")\u3002\n\n\u73b0\u5728\u4e92\u8054\u7f51\u4ea7\u54c1\uff0c**\u611f\u89c9**\u8c01\u5bb6\u7684App\u4e0d\u6574\u70b9\u89c6\u9891\u529f\u80fd\uff0c\u4e25\u683c\u610f\u4e49\u4e0a\u90fd\u4e0d\u80fd\u8bf4\u662f\u4e00\u4e2a\u73b0\u4ee3\u4e92\u8054\u7f51App\u4e86\ud83d\ude02\uff0c\u6211\u4eec\u77e5\u9053\u6700\u706b\u7684\u662f\u6296\u97f3\u3001\u5feb\u624b\u8fd9\u7c7b\u77ed\u89c6\u9891App\uff0c\u5728\u5237\u89c6\u9891\u7684\u540c\u65f6\uff0c\u4ed6\u4eec\u7684App\u4ea4\u4e92\u4e0a\u9762\u7684\u4e00\u4e9b\u7279\u8272\u80fd\u8ba9\u6211\u4eec\u4e00\u76f4\u6c89\u6d78\u5728\u5237\u89c6\u9891\u4e2d\uff1b\n\n\u6bd4\u5982\uff0c\u6211\u4eec\u4eca\u5929\u8981\u804a\u7684\uff0c\u77ed\u89c6\u9891\u7ffb\u9875\u6d41\u5217\u8868\uff0c\u89c6\u9891\u52a0\u8f7d\u7f13\u51b2\u7684\u65f6\u5019\uff0c**Loading\u7684\u8bbe\u8ba1**\uff1a\n\n```js\n\u5b83\u8bbe\u8ba1\uff1a\u5728\u89c6\u9891\u5e95\u90e8\uff0c\u8fdb\u5ea6\u6761\u4e0a\u9762\uff0c\u5f53\u89c6\u9891\u7f13\u51b2\u52a0\u8f7d\u7b49\u5f85\u7684\u65f6\u5019\uff0c\u5b83\u6709\u4e00\u4e2a\u6ce2\u7eb9\u7684\u6269\u6563\u6548\u679c\uff0c\n\u5373\u4e0d\u5e72\u6270\u7528\u6237\u5237\u89c6\u9891\u7684\u64cd\u4f5c\uff0c\u4e5f\u6ca1\u6709\u5f88\u660e\u663e\u7684\u7a81\u5140\u6548\u679c\n\uff08\u6bd4\u5982\uff1a\u7a81\u5140\u7684\u5c4f\u5e55\u4e2d\u95f4\u5927\u5706\u5708Loading\uff0c\u5c31\u5f88\u7a81\u5140\uff09\n```\n\n**\u4e00\u5b9a\u8981\u8bb0\u5f97**\uff1a\u300e**\u70b9\u8d5e\u2764\ufe0f+\u5173\u6ce8\u2764\ufe0f+\u6536\u85cf\u2764\ufe0f**\u300f\u8d77\u6765\uff0c**\u5212\u8d70\u4e86**\u53ef\u5c31**\u518d\u4e5f\u627e\u4e0d\u5230\u4e86**\ud83d\ude05\ud83d\ude05\ud83d\ude48\ud83d\ude48\n\n\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e0b\u201c**\u6296\u97f3\u3001\u5feb\u624bApp**\u201d\u7684\u89c6\u9891\u8fdb\u5ea6\u6761**Loading**\u6548\u679c\uff08`GIF\u56fe\u7a0d\u5fae\u5931\u771f\u4e86\u70b9`\uff09\n\n<p align=center><img  width=\"60%\" src=\"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a8dac6959c654b238fe1b4b4b67e3163~tplv-k3u1fbpfcp-watermark.image?\" alt=\"2022-08-20 09_33_56.gif\"  /><br/><b>\u5feb\u624b\u77ed\u89c6\u9891\u9996\u9875\u7684\u89c6\u9891Loading</b></p>\n\n\u4ece\u89c6\u9891\u91cc\u9762\u53ef\u4ee5\u770b\u51fa\u6765\u5728\u89c6\u9891\u5e95\u90e8\uff0c\u51fa\u73b0\u7f13\u51b2\u52a0\u8f7d\u89c6\u9891\u7684\u65f6\u5019\uff0c\u4f1a\u6709\u4e00\u4e2a\uff1a\u201c\u4ece**\u4e2d\u95f4\u5f802\u8fb9\u6269\u6563**\u201d\u7684\u6548\u679c\u3002\n\nGIF\u56fe\u653e\u6162\u4e86\u4e00\u70b9\uff0c\u65b9\u4fbf\u5927\u5bb6\u89c2\u770b\uff0c\u5b9e\u9645\u7814\u7a76\u8fc7\u7a0b\uff0c\u6211\u4e00\u822c\u662f\u901a\u8fc7\u5f55\u5236\u5b8c\u89c6\u9891\uff0c\u901a\u8fc7\u76f8\u518c\u7684\u89c6\u9891\u7f16\u8f91\uff0c\u53bb**\u4e00\u5e27\u4e00\u5e27\u770b**\uff0c\u505a\u4e86\u54ea\u4e9b\u52a8\u4f5c\uff0c\u5982\u4e0b\uff1a\n\n<p align=center><img src=\"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/08c96045befe44d6a5debf97ad5916ab~tplv-k3u1fbpfcp-watermark.image?\" alt=\"2022-08-20 09_44_25.gif\" width=\"30%\" /></p>\n\n\u770b\u5b8c\uff0c\u6211\u4eec\u53d1\u73b0\uff1a\n\n```js\n1\u3001\u4e00\u5f00\u59cb\u662f\u5728\u5c4f\u5e55\u4e2d\u95f4\u7684\u4f4d\u7f6e\uff0c\u5927\u6982\u662f20dp\u5de6\u53f3\u7684\u5bbd\u5ea6\u5f00\u59cb\u663e\u793a\uff1b\n2\u3001\u4ece\u4e2d\u95f4\u6269\u6563\u5230\u5c4f\u5e55\u8fb9\u7f18\u4e4b\u540e\uff0c\u4f1a\u6267\u884c\u6e10\u9690\uff1b\n3\u3001\u6e10\u9690\u5230\u900f\u660e\uff0c\u53c8\u5f00\u59cb\u4ece\u4e2d\u95f4\u5f802\u8fb9\u6269\u6563\uff1b\n```\n\u6709\u4e86\u4e0a\u9762\u7684\u524d\u594f\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f00\u59cb\u6211\u4eec\u7684\u7f16\u7801\u4e86\uff0c\u90a3\u4e48\u5728\u5f00\u59cb\u7f16\u7801\u524d\uff0c\u80af\u5b9a\u9700\u8981\u77e5\u9053\u5bbd\u5ea6\u662f\u591a\u5c11\uff0c\u8fd9\u91cc\u6211\u4eec\u62ff**BoxWithConstraints**\u6765\u5305\u6211\u4eec\u7684child composable\uff0c\n\u6211\u4eec\u53ef\u4ee5\u770b\u5230BoxWithConstraints\u7684\u4ee3\u7801\u5982\u4e0b\uff1a\n\n\n```kotlin\n// \u4ee3\u7801\u6765\u81ea\uff1aandroidx.compose.foundation.layout\n@Composable\n@UiComposable\nfun BoxWithConstraints(\n    modifier: Modifier = Modifier,\n    contentAlignment: Alignment = Alignment.TopStart,\n    propagateMinConstraints: Boolean = false,\n    content:\n        @Composable @UiComposable BoxWithConstraintsScope.() -> Unit\n) {\n    val measurePolicy = rememberBoxMeasurePolicy(contentAlignment, propagateMinConstraints)\n    SubcomposeLayout(modifier) { constraints ->\n        val scope = BoxWithConstraintsScopeImpl(this, constraints)\n        val measurables = subcompose(Unit) { scope.content() }\n        with(measurePolicy) { measure(measurables, constraints) }\n    }\n}\n```\n\n\u91cc\u9762\u7528\u5230\u4e86SubcomposeLayout\uff0c\u6765\u63a8\u8fdf\u5185\u5bb9\u7ec4\u5408\uff0c\u6211\u4eec\u53ef\u4ee5\u5728**BoxWithConstraintsScope**\u91cc\u9762\u83b7\u53d6\u5230\u6700\u5927\u5bbd\u5ea6maxWidth **(\u5355\u4f4ddp)**\u3002\n\nLoading\u7ebf\u6761\uff0c\u6211\u4eec\u53ef\u4ee5\u7528DrawScope.drawLine\u6765\u753b\uff0c\u6269\u6563\u6548\u679c\u80af\u5b9a\u9700\u8981\u6709\u52a8\u753b\u6765\u66f4\u65b0\u3002\n\n\u6211\u4eec\u4f7f\u7528 **rememberInfiniteTransition()** \u6267\u884c\u65e0\u9650\u52a8\u753b\uff0c\u4f7f\u7528**animateFloat**\u6765\u83b7\u53d6\u52a8\u753b\u66f4\u65b0\u7684\u503c\uff1a\n\n```kotlin\n// \u4ee3\u7801\u6765\u81ea\uff1aandroidx.compose.animation.core\n@Composable\nfun InfiniteTransition.animateFloat(\n    initialValue: Float,\n    targetValue: Float,\n    animationSpec: InfiniteRepeatableSpec<Float>\n): State<Float>\n```\n\u521d\u59cb\u503c(**initialValue**)\u53ef\u4ee5\u5b9a\u4e49\u621050F`(\u8bfb\u8005\u53ef\u81ea\u884c\u4fee\u6539)`\uff0c\u76ee\u6807\u503c(**targetValue**)\u5b9a\u4e49\u591a\u5c11\u5408\u9002\u5462\uff1f\n\n\u901a\u8fc7\u6162\u955c\u5934\u67e5\u770b\u201c**\u6296\u97f3\u3001\u5feb\u624b**\u201d\u7684\u6548\u679c\uff0c\u53d1\u73b0\u5b83\u6269\u6563\u5b8c\uff0c\u4f1a\u201c\u6e10\u9690\u5230\u900f\u660e\u201d\uff0c\u7136\u540e\u518d\u4ece**intialValue**\u5904\u5f00\u59cb\u91cd\u65b0\u6269\u6563\u3002\n\n**targetValue**\u5b9a\u4e49\u6210**maxWidth\u4e0d\u884c**\uff0c\u90a3\u4e48\u6211\u4eec\u62c9\u5927\u8fd9\u4e2a\u6570\u503c\uff0c\u53ef\u4ee5\u5b9a\u4e49\u6210\u5927\u6982**1.8\u500d\u7684maxWidth**;\n\n\u7531\u4e8emaxWidth\u83b7\u53d6\u5230\u7684\u662fdp\u5355\u4f4d\u7684\uff0c\u6211\u4eec\u9700\u8981\u8f6c\u6362\u6210px\uff0c\u4e0b\u9762\u6211\u4eec\u7edf\u4e00\u53eb\uff1a**width**\n\n\n```kotlin\nval width = with(LocalDensity.current) {  maxWidth.toPx() }\n```\n\n\u7136\u540e\uff0c\u6211\u4eec\u7684**\u7ebf\u6761\u52a8\u753b\u503c**\u5c31\u53d8\u6210\u4e0b\u9762\u8fd9\u6837\uff1a\n\n```kotlin\nval lineProgressAnimValue by infiniteTransition.animateFloat(\n    initialValue = 100F,\n    targetValue = width * 1.8F,\n    animationSpec = infiniteRepeatable(\n            animation = tween(\n            durationMillis = TIME_PERIOD,\n            easing = FastOutLinearInEasing\n        )\n    )\n)\nprivate const val TIME_PERIOD = 1100\n```\n\n\u7ebf\u6761\u6269\u6563\u5230\u5c4f\u5e55\u8fb9\u7f18\u7684\u65f6\u5019\uff0c\u9700\u8981**\u6267\u884c\u6e10\u9690**\uff0c\u5f97\u51fa\u4e0b\u9762\u7684alpha\n\n```kotlin\nval lineAlphaValue = if(lineProgressAnimValue <= width) {\n    // \u8bfb\u8005\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u4f53\u9a8c\n    lineProgressAnimValue * 1.0F/ width * 1.0F\n    // \u8bfb\u8005\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u4f53\u9a8c\n    //Math.min((lineProgressAnimValue.value) * 1.0F / width * 1.0F, 0.7F)\n    // \u6296\u97f3\u3001\u5feb\u624b\u770b\u6548\u679c\u90fd\u662f1F\uff0c\u6839\u636e\u81ea\u5df1\u4f53\u9a8c\u6765\u8bbe\u7f6e\u5427\n    // 1F\n} else {\n    // \u6269\u6563\u5230\u5c4f\u5e55\u8fb9\u7f18\u7684\u65f6\u5019\uff0c\u5f00\u59cb\u89e6\u53d1\uff1a\u6e10\u9690\n    (width * 1.8F - lineProgressAnimValue) / width * 0.8F\n}\n// \u7ebf\u6761\u5bbd\u5ea6\nval lineWidth = if(lineProgressAnimValue <= width) {\n    lineProgressAnimValue / 2\n} else {\n    width / 2\n}\n```\n\n\u6700\u540e\uff0c\u6211\u4eec\u901a\u8fc7**Canvas**\u6765\u7ed8\u5236\u8fd9\u4e2a\u7ebf\u6761\n\n```kotlin\nCanvas(modifier = modifier) {\n    drawLine(\n        color = Color.White.copy(alpha = lineAlphaValue),\n        start = Offset(x = size.width / 2 - lineWidth, y = 0F),\n        end = Offset(x = size.width / 2 + lineWidth, y = 0F),\n        strokeWidth = 2.5F\n    )\n}\n```\n\u6765\u770b\u770b\u6211\u4eec\u7684\u6700\u7ec8\u6548\u679c\u5427\uff1a\n\n<p align=center><img src=\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c3823d91b2204aba93dd21e257100406~tplv-k3u1fbpfcp-watermark.image?\" alt=\"2022-08-20 10_51_22.gif\" width=\"70%\" /></p>\n\n\n---------\n\n\n**\u5f80\u671f\u6587\u7ae0\u63a8\u8350\uff1a**    \n[**1.Jetpack Compose UI\u521b\u5efa\u5e03\u5c40\u7ed8\u5236\u6d41\u7a0b+\u539f\u7406 \u2014\u2014 \u5185\u542b\u6982\u5ff5\u8be6\u89e3\uff08\u6ee1\u6ee1\u5e72\u8d27\uff09**](https://juejin.cn/post/7003606223438217223)<br/>\n[**2.\u6b63\u786e\u5b9e\u8df5Jetpack SplashScreen API \u2014\u2014 \u5728\u6240\u6709Android\u7cfb\u7edf\u4e0a\u4f7f\u7528\u603b\u7ed3\uff0c\u5185\u542b\u539f\u7406\u5206\u6790**](https://juejin.cn/post/7019839767441309733)<br/>\n[**3.\u6e90\u7801\u5206\u6790 | ThreadedRenderer\u7a7a\u6307\u9488\u95ee\u9898\uff0c\u987a\u4fbf\u628aChoreographer\u8ba4\u8bc6\u4e00\u4e0b**](https://juejin.cn/post/7002537215154716686)<br/>\n[**4.\u6e90\u7801\u5206\u6790 | \u4e8b\u4ef6\u662f\u600e\u4e48\u4f20\u9012\u5230Activity\u7684\uff1f**](https://juejin.cn/post/6994376402330091551)<br/>\n[**5.Jetpack Compose - FloatingActionButton \u5c55\u5f00/\u6298\u53e0 \u7684\u591a\u7ea7\u60ac\u6d6e\u83dc\u5355**](https://juejin.cn/post/6969562505878175781)<br/>\n[**6.\u5982\u4f55\u7981\u7528\u65e0\u969c\u788d\u6a21\u62df\u70b9\u51fb\uff0c\u63d0\u9ad8\u5e94\u7528\u6536\u76ca**](https://juejin.cn/post/6953937584443621412)    \n",
    "mtime": "1660966728",
    "original_author": "",
    "original_type": 0,
    "rank_index": 8.50490567,
    "rtime": "1660966727",
    "status": 2,
    "tag_ids": [
      6809640400832167936,
      6809641107346063360,
      6809640615584727040
    ],
    "title": "Compose\u5236\u4f5c\u201c\u6296\u97f3\u201d\u3001\u201c\u5feb\u624b\u201d\u89c6\u9891\u8fdb\u5ea6\u6761Loading\u52a8\u753b\u6548\u679c",
    "user_id": "8451824316670",
    "user_index": 12.245623163941787,
    "verify_status": 1,
    "view_count": 101,
    "visible_level": 0
  }